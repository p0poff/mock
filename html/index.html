<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark" />
    <link rel="stylesheet" href="./html/pico.amber.min.css">
    <link rel="icon" type="image/png" sizes="32x32" href="./html/favicon-32x32.png">
    <title>Simple mock server</title>
    <style>
      .label_70 {font-size: 70%;}
      .red {color: red;}
    </style>
  </head>
  <body>
    <main class="container">
      <h1>Mock server admin panel</h1>
      
      <div role="group">
        <h3>Routing</h3>
        <div>
          <button id="import_db_btn" data-tooltip="Import db" data-placement="left">üì•</button>
          <a href="./admin/export.db" role="button" tabindex="0" data-tooltip="Export db" data-placement="right">üì§</a>
        </div>
        <button id="open_log_btn">Requests log</button>
      </div>
      <table>
        <thead data-theme="dark">
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Route</th>
            <th scope="col">Method</th>
            <th scope="col">Status code</th>
            <th scope="col">Options</th>
          </tr>
        </thead>
        <tbody id="table_body">
          
        </table>
        <div id="add_route_btn" role="button">ADD Route</div>
      </main>

      <template id="table_row">
        <tr>
          <td class="row_id">1</td>
          <th scope="row" class="row_route">api/v1/comm_calendar/events</th>
          <td class="row_method">GET</td>
          <td class="row_code">200</td>
          <td>
            <div role="group">
              <button class="contrast row_edit_btn">Edit</button>
              <div></div>
              <button class="secondary row_del_btn">Del</button>
            </div>
        </tr>
      </template>

      <dialog id="modal_dialog">
        <article>
          <header>
            <button id="modal_close_btn" aria-label="Close" rel="prev"></button>
            <p>
              <strong>Sending route</strong>
            </p>
          </header>
          <div class="container">
            <input type="hidden" id="modal_data_id" name="id" />
            <label class="label_70">
              Route
              <input type="text" id="modal_data_route" name="route" placeholder="/" aria-label="route" />
            </label>
            <div class="grid">
              <label class="label_70">
                Method
                <select id="modal_data_method" name="method" aria-label="method" required>
                  <option selected disabled value="">
                    Select method...
                  </option>
                  <option>GET</option>
                  <option>POST</option>
                  <option>PUT</option>
                  <option>DELETE</option>
                </select>
              </label>
              <label class="label_70">
                Status code
                <input type="number" id="modal_data_code" name="code" placeholder="status code" aria-label="code" />
              </label>
            </div>
            <label class="label_70">
              Default headers {"Content-Type", "application/json"}<br />
              Can be redefined
              <textarea
                id="modal_data_headers"
                name="headers"
                placeholder="headers, must valid JSON1"
                aria-label="headers"
              ></textarea>
            </label>
            <label class="label_70">
              Can be every type, but for a correct answer, the type must match the header "Content-Type"
              <textarea
                id="modal_data_body"
                name="body"
                placeholder="body"
                aria-label="body"
              ></textarea>
            </label>  
            <input
              id="modal_submit_btn"
              type="submit"
              value="Send"
            />
          </div>
          
        </article>
      </dialog>

      <dialog id="modal_dialog_log">
        <article>
          <header>
            <button id="modal_log_close_btn" aria-label="Close" rel="prev"></button>
            <p>
              <strong>Requests log</strong>
            </p>
          </header>
          <div class="container" style="overflow: scroll;">
            <div id="modal_log_area" style="width: 150%; max-height: 500px;"></div>
          </div> 
          <div role="group">
            <div id="modal_log_refresh_btn" role="button">üîÑ Refresh requests</div>
            <button id="modal_log_clear_btn" class="secondary">üóëÔ∏è Clear log</button>
          </div>
        </article>
      </dialog>

      <dialog id="modal_dialog_upload_file">
        <article>
          <header>
            <button id="modal_upload_file_close_btn" aria-label="Close" rel="prev"></button>
            <p>
              <strong>Import DB</strong>
            </p>
          </header>
          <form class="container" id="modal_upload_form" enctype="multipart/form-data">
            <label class="label_70">
              The downloaded sqlite DB file will remove the current routers.
              <input type="file" id="modal_upload_file" name="file">
            </label>
            <button type="submit" data-tooltip="Current routes will be erased">Import</button>
        </form>
        <div class="container label_70 red" id="modal_upload_error"></div>
        </article>
      </dialog>

      <footer class="container">
        v 0.1.1
      </footer>

      <script src="./html/mock.js"></script>
  </body>
</html>